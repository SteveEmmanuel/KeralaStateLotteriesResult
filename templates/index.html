{% extends "layout.html" %}
{% block content %}
<table id="lotteries" class="table table-striped table-bordered" style="width:100%">
    <thead>
        <tr>
            <th class="col-md-2">Date</th>
            <th class="col-md-4">Lottery</th>
            <th class="col-md-4">Series</th>
            <th class="col-md-2">Results</th>
        </tr>
    </thead>
</table>
{% endblock %}

{% block script %}
<script>
$( document ).ready(function() {
    console.log( "ready!" );

    	/*Menu-toggle*/
    $("#menu-toggle").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("active");
    });

    $('#lotteries').DataTable( {
        "dom": "<'toolbar'>frtip ",
        "length": '10',
        "bSearchable":true,
        "order": [[ 0, "desc" ]],
        "serverSide": true,
        "ajax": {
            "data": function ( d ) {
                        d.date = $('.datePicker').val();
                    },
        "url": '/page',
        "type": 'POST',
            },
        "columns": [{ "data": 0},{ "data": 1 },{ "data": 2},
                    {render: function ( data, type, row ) {return '<a class="results btn btn-primary" role="button"  href="/result/'+data+'" target="_blank" value="'+data+'">View Result</a>';}}],
        "columnDefs": [{ orderable: false, targets: [2, 3] }
]

    } );
    $(".toolbar").html('<div class="row col-md-6"><input type="buttons" class="datePicker col-sm-6 margin10"></input><button type="button" id="clearDate" class="btn btn-primary col-sm-2">Clear</button></div>');
    $('.datePicker').datepicker({
            format: 'dd-mm-yyyy',
        });
    $('.datePicker').datepicker().on('changeDate clearDate', function(e) {
            console.log("triggered");
            $('#lotteries').DataTable().draw();
        });
     $('#clearDate').click(function(){ $('.datePicker').datepicker('clearDates')});
     //$('.results').click(function(){ debugger; console.log($(this).attr('value')); });
});

</script>
{% endblock %}
